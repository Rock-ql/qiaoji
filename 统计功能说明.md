# ðŸ“Š ç»Ÿè®¡åŠŸèƒ½è¯´æ˜Žæ–‡æ¡£

## åŠŸèƒ½æ¦‚è¿°

è®°è´¦ç»Ÿè®¡åŠŸèƒ½å·²å®Œæ•´å®žçŽ°ï¼Œæ”¯æŒæŒ‰**å‘¨/æœˆ/å¹´**ä¸‰ä¸ªç»´åº¦æŸ¥çœ‹å„åˆ†ç±»çš„æ”¶æ”¯ç»Ÿè®¡æ•°æ®ã€‚ç”¨æˆ·å¯ä»¥çµæ´»é€‰æ‹©ä¸åŒçš„æ—¶é—´å‘¨æœŸï¼ŒæŸ¥çœ‹è¯¦ç»†çš„æ”¶å…¥ã€æ”¯å‡ºå’Œåˆ†ç±»æ˜Žç»†ã€‚

---

## ä¸€ã€åŠŸèƒ½ç‰¹æ€§

### 1.1 æ—¶é—´ç»´åº¦åˆ‡æ¢
- **å‘¨ç»Ÿè®¡**ï¼šæœ¬å‘¨ã€ä¸Šå‘¨ã€åŽ†å²å‘¨ï¼ˆç¬¬XXå‘¨ï¼‰
- **æœˆç»Ÿè®¡**ï¼šæœ¬æœˆã€ä¸Šæœˆã€åŽ†å²æœˆä»½
- **å¹´ç»Ÿè®¡**ï¼šä»Šå¹´ã€åŽ»å¹´ã€åŽ†å²å¹´ä»½

### 1.2 æ™ºèƒ½å‘¨æœŸé€‰æ‹©
- è‡ªåŠ¨è¯†åˆ«æœ‰äº¤æ˜“æ•°æ®çš„æ—¶é—´å‘¨æœŸ
- åªæ˜¾ç¤ºåŒ…å«äº¤æ˜“è®°å½•çš„å‘¨æœŸé€‰é¡¹
- æ”¯æŒå¿«é€Ÿåˆ‡æ¢"æœ¬å‘¨/æœ¬æœˆ/ä»Šå¹´"å’Œ"ä¸Šå‘¨/ä¸Šæœˆ/åŽ»å¹´"

### 1.3 æ•°æ®ç»Ÿè®¡ç»´åº¦
- **æ±‡æ€»æ•°æ®**ï¼šæ€»æ”¶å…¥ã€æ€»æ”¯å‡ºã€ç»“ä½™é‡‘é¢ã€äº¤æ˜“ç¬”æ•°
- **åˆ†ç±»ç»Ÿè®¡**ï¼šæ¯ä¸ªåˆ†ç±»çš„é‡‘é¢ã€ç¬”æ•°ã€å æ¯”
- **ç±»åž‹åˆ‡æ¢**ï¼šæ”¯æŒæŸ¥çœ‹æ”¶å…¥ç»Ÿè®¡å’Œæ”¯å‡ºç»Ÿè®¡

### 1.4 å¯è§†åŒ–å±•ç¤º
- æ±‡æ€»å¡ç‰‡ï¼šç›´è§‚å±•ç¤ºæ”¶æ”¯æƒ…å†µ
- åˆ†ç±»åˆ—è¡¨ï¼šå¸¦å›¾æ ‡å’Œé¢œè‰²çš„åˆ†ç±»æ˜Žç»†
- ç™¾åˆ†æ¯”æ˜¾ç¤ºï¼šå„åˆ†ç±»å æ¯”ä¸€ç›®äº†ç„¶

---

## äºŒã€æ–‡ä»¶ç»“æž„

### 2.1 åˆ›å»ºçš„æ–‡ä»¶æ¸…å•

```
ExpenseTracker/Features/Statistics/
â”œâ”€â”€ Models/
â”‚   â””â”€â”€ StatisticsModels.swift         # æ•°æ®æ¨¡åž‹å®šä¹‰
â”œâ”€â”€ Services/
â”‚   â””â”€â”€ StatisticsService.swift        # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â””â”€â”€ Views/
    â”œâ”€â”€ StatisticsView.swift           # ä¸»ç»Ÿè®¡é¡µé¢
    â”œâ”€â”€ PeriodSelectorView.swift       # æ—¶é—´é€‰æ‹©å™¨
    â”œâ”€â”€ StatisticsSummaryCard.swift    # æ±‡æ€»å¡ç‰‡
    â””â”€â”€ CategoryStatisticsRow.swift    # åˆ†ç±»ç»Ÿè®¡è¡Œ
```

**æ–‡ä»¶è¯´æ˜Ž**ï¼š
- **StatisticsModels.swift** (160è¡Œ)ï¼šå®šä¹‰äº†TimePeriodã€PeriodOptionã€CategoryStatisticsã€PeriodStatisticsç­‰æ ¸å¿ƒæ•°æ®æ¨¡åž‹
- **StatisticsService.swift** (382è¡Œ)ï¼šå®žçŽ°æ•°æ®æŸ¥è¯¢ã€èšåˆã€å‘¨æœŸè®¡ç®—ç­‰ä¸šåŠ¡é€»è¾‘
- **StatisticsView.swift** (172è¡Œ)ï¼šä¸»ç»Ÿè®¡é¡µé¢ï¼Œæ•´åˆæ‰€æœ‰å­ç»„ä»¶
- **PeriodSelectorView.swift** (47è¡Œ)ï¼šæ—¶é—´ç»´åº¦å’Œå‘¨æœŸé€‰æ‹©å™¨UIç»„ä»¶
- **StatisticsSummaryCard.swift** (79è¡Œ)ï¼šæ”¶æ”¯æ±‡æ€»å¡ç‰‡UIç»„ä»¶
- **CategoryStatisticsRow.swift** (58è¡Œ)ï¼šå•ä¸ªåˆ†ç±»ç»Ÿè®¡è¡ŒUIç»„ä»¶

**æ€»ä»£ç é‡**ï¼šçº¦ **900è¡Œ**ï¼ˆå«æ³¨é‡Šï¼‰

### 2.2 ä¿®æ”¹çš„æ–‡ä»¶

- **ContentView.swift**ï¼š
  - åˆ é™¤äº†å ä½çš„StatisticsViewï¼ˆç¬¬313-335è¡Œï¼‰
  - åˆ é™¤äº†é‡å¤çš„Coloræ‰©å±•ï¼ˆç¬¬569-591è¡Œï¼‰
  - æ›´æ–°äº†TransactionRowçš„é¢œè‰²åˆå§‹åŒ–æ–¹å¼ï¼ˆç¬¬286è¡Œï¼‰

---

## ä¸‰ã€æ ¸å¿ƒå®žçŽ°é€»è¾‘

### 3.1 æ•°æ®æ¨¡åž‹è®¾è®¡

#### TimePeriodï¼ˆæ—¶é—´ç»´åº¦æžšä¸¾ï¼‰
```swift
enum TimePeriod {
    case week   // å‘¨
    case month  // æœˆ
    case year   // å¹´
}
```

#### PeriodOptionï¼ˆå‘¨æœŸé€‰é¡¹ç»“æž„ï¼‰
```swift
struct PeriodOption {
    let displayName: String     // æ˜¾ç¤ºåç§°ï¼ˆå¦‚"æœ¬å‘¨"ã€"2025å¹´ç¬¬10å‘¨"ï¼‰
    let startDate: Date         // å¼€å§‹æ—¥æœŸ
    let endDate: Date           // ç»“æŸæ—¥æœŸ
    let period: TimePeriod      // æ—¶é—´ç»´åº¦
    var isCurrent: Bool         // æ˜¯å¦ä¸ºå½“å‰å‘¨æœŸ
}
```

#### CategoryStatisticsï¼ˆåˆ†ç±»ç»Ÿè®¡ï¼‰
```swift
struct CategoryStatistics {
    let categoryName: String     // åˆ†ç±»åç§°
    let categoryIcon: String     // åˆ†ç±»å›¾æ ‡
    let categoryColor: String    // åˆ†ç±»é¢œè‰²
    let amount: Double           // é‡‘é¢æ€»è®¡
    let transactionCount: Int    // äº¤æ˜“ç¬”æ•°
    let percentage: Double       // å æ¯”ï¼ˆ0.0-1.0ï¼‰
}
```

#### PeriodStatisticsï¼ˆå‘¨æœŸæ±‡æ€»ï¼‰
```swift
struct PeriodStatistics {
    let period: PeriodOption            // å‘¨æœŸä¿¡æ¯
    let totalIncome: Double             // æ€»æ”¶å…¥
    let totalExpense: Double            // æ€»æ”¯å‡º
    let balance: Double                 // ç»“ä½™
    let incomeCount: Int                // æ”¶å…¥ç¬”æ•°
    let expenseCount: Int               // æ”¯å‡ºç¬”æ•°
    let incomeCategories: [...]         // æ”¶å…¥åˆ†ç±»ç»Ÿè®¡
    let expenseCategories: [...]        // æ”¯å‡ºåˆ†ç±»ç»Ÿè®¡
}
```

---

### 3.2 æ ¸å¿ƒç®—æ³•

#### å‘¨æœŸé€‰é¡¹ç”Ÿæˆç®—æ³•

**å‘¨é€‰é¡¹ç”Ÿæˆ**ï¼ˆgetWeekOptionsï¼‰ï¼š
1. èŽ·å–æœ¬å‘¨å’Œä¸Šå‘¨çš„æ—¶é—´èŒƒå›´
2. æŸ¥è¯¢æ‰€æœ‰äº¤æ˜“è®°å½•
3. æŒ‰å‘¨åˆ†ç»„ï¼Œæå–æœ‰æ•°æ®çš„å‘¨
4. ç”Ÿæˆå‘¨æœŸé€‰é¡¹åˆ—è¡¨ï¼ˆæœ€å¤š52å‘¨ï¼‰

**æœˆé€‰é¡¹ç”Ÿæˆ**ï¼ˆgetMonthOptionsï¼‰ï¼š
1. èŽ·å–æœ¬æœˆå’Œä¸Šæœˆçš„æ—¶é—´èŒƒå›´
2. æŸ¥è¯¢æ‰€æœ‰äº¤æ˜“è®°å½•
3. æŒ‰æœˆåˆ†ç»„ï¼Œæå–æœ‰æ•°æ®çš„æœˆä»½
4. ç”Ÿæˆå‘¨æœŸé€‰é¡¹åˆ—è¡¨ï¼ˆæœ€å¤š24ä¸ªæœˆï¼‰

**å¹´é€‰é¡¹ç”Ÿæˆ**ï¼ˆgetYearOptionsï¼‰ï¼š
1. èŽ·å–ä»Šå¹´å’ŒåŽ»å¹´çš„æ—¶é—´èŒƒå›´
2. æŸ¥è¯¢æ‰€æœ‰äº¤æ˜“è®°å½•
3. æŒ‰å¹´åˆ†ç»„ï¼Œæå–æœ‰æ•°æ®çš„å¹´ä»½
4. ç”Ÿæˆå‘¨æœŸé€‰é¡¹åˆ—è¡¨ï¼ˆæœ€å¤š10å¹´ï¼‰

#### ç»Ÿè®¡æ•°æ®è®¡ç®—ç®—æ³•

**calculateStatisticsæ–¹æ³•**ï¼š
```swift
1. ä½¿ç”¨PredicateæŸ¥è¯¢æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„äº¤æ˜“
   - æ¡ä»¶ï¼štransaction.date >= startDate && transaction.date < endDate

2. åˆ†ç¦»æ”¶å…¥å’Œæ”¯å‡ºäº¤æ˜“
   - incomeTransactions = transactions.filter { $0.type == .income }
   - expenseTransactions = transactions.filter { $0.type == .expense }

3. è®¡ç®—æ€»é¢
   - totalIncome = sum(incomeTransactions.amount)
   - totalExpense = sum(expenseTransactions.amount)
   - balance = totalIncome - totalExpense

4. æŒ‰åˆ†ç±»èšåˆ
   - ä½¿ç”¨Dictionary(grouping:) æŒ‰category.idåˆ†ç»„
   - å¯¹æ¯ä¸ªåˆ†ç±»æ±‚å’Œã€è®¡æ•°ã€è®¡ç®—å æ¯”

5. è¿”å›žPeriodStatisticsç»“æž„
```

**åˆ†ç±»èšåˆç®—æ³•**ï¼ˆaggregateByCategoryï¼‰ï¼š
```swift
1. æŒ‰åˆ†ç±»IDåˆ†ç»„
   Dictionary(grouping: transactions) { $0.category?.id }

2. å¯¹æ¯ä¸ªåˆ†ç±»è®¡ç®—
   - amount = è¯¥åˆ†ç±»æ‰€æœ‰äº¤æ˜“çš„é‡‘é¢æ€»å’Œ
   - count = è¯¥åˆ†ç±»çš„äº¤æ˜“ç¬”æ•°
   - percentage = amount / total

3. æŒ‰é‡‘é¢é™åºæŽ’åº
   sorted { $0.amount > $1.amount }
```

---

### 3.3 UIäº¤äº’æµç¨‹

```
ç”¨æˆ·æ“ä½œæµç¨‹ï¼š
1. æ‰“å¼€"ç»Ÿè®¡"Tab
   â†“
2. é€‰æ‹©æ—¶é—´ç»´åº¦ï¼ˆå‘¨/æœˆ/å¹´ï¼‰
   â†’ è§¦å‘loadPeriodOptions()
   â†’ ç”Ÿæˆå‘¨æœŸé€‰é¡¹åˆ—è¡¨
   â†’ è‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªé€‰é¡¹
   â†“
3. é€‰æ‹©å…·ä½“å‘¨æœŸï¼ˆæœ¬å‘¨/ä¸Šå‘¨/æŸä¸ªåŽ†å²å‘¨æœŸï¼‰
   â†’ è§¦å‘calculateStatistics()
   â†’ æŸ¥è¯¢äº¤æ˜“æ•°æ®
   â†’ èšåˆç»Ÿè®¡
   â†’ æ›´æ–°UIæ˜¾ç¤º
   â†“
4. åˆ‡æ¢æ”¶å…¥/æ”¯å‡ºTab
   â†’ åˆ‡æ¢æ˜¾ç¤ºä¸åŒçš„åˆ†ç±»ç»Ÿè®¡åˆ—è¡¨
   â†“
5. æŸ¥çœ‹å…·ä½“åˆ†ç±»æ•°æ®
   â†’ æ˜¾ç¤ºåˆ†ç±»å›¾æ ‡ã€åç§°ã€é‡‘é¢ã€ç¬”æ•°ã€å æ¯”
```

---

## å››ã€ä½¿ç”¨è¯´æ˜Ž

### 4.1 åœ¨Xcodeä¸­æ·»åŠ æ–‡ä»¶

ç”±äºŽæ–‡ä»¶æ˜¯é€šè¿‡æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºçš„ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ åˆ°Xcodeé¡¹ç›®ï¼š

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨Xcode GUIæ·»åŠ **
1. æ‰“å¼€Xcodeé¡¹ç›®
2. å³é”®ç‚¹å‡» `ExpenseTracker/Features` ç›®å½•
3. é€‰æ‹© "Add Files to ExpenseTracker..."
4. å¯¼èˆªåˆ° `ExpenseTracker/Features/Statistics` ç›®å½•
5. å‹¾é€‰ "Copy items if needed" å’Œ "Create groups"
6. ç‚¹å‡» "Add"

**æ–¹æ³•äºŒï¼šæ‹–æ‹½æ·»åŠ **
1. åœ¨Finderä¸­æ‰“å¼€ `ExpenseTracker/Features/Statistics` ç›®å½•
2. å°†æ•´ä¸ª `Statistics` æ–‡ä»¶å¤¹æ‹–æ‹½åˆ°Xcodeçš„ `Features` ç»„ä¸­
3. ç¡®ä¿å‹¾é€‰ "Copy items if needed" å’Œ "Create groups"

### 4.2 éªŒè¯é›†æˆ

æ·»åŠ æ–‡ä»¶åŽï¼Œæ‰§è¡Œä»¥ä¸‹æ£€æŸ¥ï¼š

1. **ç¼–è¯‘æ£€æŸ¥**
   - æŒ‰ `Cmd + B` ç¼–è¯‘é¡¹ç›®
   - ç¡®ä¿æ²¡æœ‰ç¼–è¯‘é”™è¯¯

2. **å¯¼å…¥æ£€æŸ¥**
   åœ¨StatisticsView.swiftä¸­ç¡®è®¤ä»¥ä¸‹å¯¼å…¥æ­£å¸¸ï¼š
   ```swift
   import SwiftUI
   import SwiftData
   ```

3. **è¿è¡Œæ£€æŸ¥**
   - æŒ‰ `Cmd + R` è¿è¡Œé¡¹ç›®
   - ç‚¹å‡»åº•éƒ¨å¯¼èˆªæ çš„"ç»Ÿè®¡"Tab
   - éªŒè¯ç»Ÿè®¡é¡µé¢æ­£å¸¸æ˜¾ç¤º

### 4.3 æµ‹è¯•æ•°æ®å‡†å¤‡

ä¸ºäº†æµ‹è¯•ç»Ÿè®¡åŠŸèƒ½ï¼Œå»ºè®®å…ˆæ·»åŠ ä¸€äº›æµ‹è¯•æ•°æ®ï¼š

1. åœ¨"äº¤æ˜“"Tabä¸­æ·»åŠ è‹¥å¹²äº¤æ˜“è®°å½•
2. é€‰æ‹©ä¸åŒçš„åˆ†ç±»
3. é€‰æ‹©ä¸åŒçš„æ—¥æœŸï¼ˆè·¨è¶Šå¤šå‘¨/å¤šæœˆï¼‰
4. æ·»åŠ æ”¶å…¥å’Œæ”¯å‡ºäº¤æ˜“

**å»ºè®®æµ‹è¯•åœºæ™¯**ï¼š
- æœ¬å‘¨æœ‰äº¤æ˜“ï¼Œä¸Šå‘¨æ— äº¤æ˜“
- è·¨æœˆäº¤æ˜“ï¼ˆä¸Šä¸ªæœˆå’Œæœ¬æœˆéƒ½æœ‰ï¼‰
- è·¨å¹´äº¤æ˜“ï¼ˆåŽ»å¹´å’Œä»Šå¹´éƒ½æœ‰ï¼‰
- æŸä¸ªåˆ†ç±»å æ¯”å¾ˆé«˜ï¼ˆ>50%ï¼‰
- æ”¶å…¥å¤§äºŽæ”¯å‡ºï¼ˆæ­£ç»“ä½™ï¼‰
- æ”¯å‡ºå¤§äºŽæ”¶å…¥ï¼ˆè´Ÿç»“ä½™ï¼‰

---

## äº”ã€åŠŸèƒ½æ¼”ç¤º

### 5.1 ç»Ÿè®¡é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»Ÿè®¡                     [ç­›é€‰]     â”‚  â† å¯¼èˆªæ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å‘¨] [æœˆ] [å¹´]                      â”‚  â† æ—¶é—´ç»´åº¦é€‰æ‹©å™¨
â”‚  â–¼ æœ¬å‘¨                             â”‚  â† å‘¨æœŸä¸‹æ‹‰èœå•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ“Š æ±‡æ€»                   12ç¬”     â”‚
â”‚  â†“ æ”¶å…¥      Â¥5,000.00             â”‚
â”‚  â†‘ æ”¯å‡º      Â¥3,200.00             â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   â”‚
â”‚  = ç»“ä½™      Â¥1,800.00             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æ”¯å‡º] [æ”¶å…¥]                      â”‚  â† ç±»åž‹åˆ‡æ¢
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ“ åˆ†ç±»æ˜Žç»†                8ä¸ªåˆ†ç±»  â”‚
â”‚                                     â”‚
â”‚  ðŸ´ é¤é¥®     Â¥800.00    25.0%   â†’  â”‚
â”‚     5ç¬”                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  ðŸš— äº¤é€š     Â¥500.00    15.6%   â†’  â”‚
â”‚     3ç¬”                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  ðŸ›’ è´­ç‰©     Â¥1,200.00  37.5%   â†’  â”‚
â”‚     2ç¬”                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  ðŸ  ä½æˆ¿     Â¥700.00    21.9%   â†’  â”‚
â”‚     2ç¬”                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ç©ºæ•°æ®çŠ¶æ€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»Ÿè®¡                     [ç­›é€‰]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å‘¨] [æœˆ] [å¹´]                      â”‚
â”‚  â–¼ æœ¬å‘¨                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚          ðŸ“Š                         â”‚
â”‚                                     â”‚
â”‚        æš‚æ— æ•°æ®                      â”‚
â”‚                                     â”‚
â”‚     è¯¥æ—¶é—´æ®µå†…æ²¡æœ‰äº¤æ˜“è®°å½•            â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å…­ã€æŠ€æœ¯ç‰¹ç‚¹

### 6.1 æ€§èƒ½ä¼˜åŒ–

1. **æŒ‰éœ€æŸ¥è¯¢**ï¼šåªæŸ¥è¯¢æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„äº¤æ˜“ï¼Œé¿å…å…¨è¡¨æ‰«æ
2. **æ‡’åŠ è½½**ï¼šå‘¨æœŸé€‰é¡¹åˆ—è¡¨å»¶è¿ŸåŠ è½½ï¼Œåªåœ¨éœ€è¦æ—¶ç”Ÿæˆ
3. **ç»“æžœç¼“å­˜**ï¼šç»Ÿè®¡ç»“æžœé€šè¿‡@Stateç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—
4. **é™åˆ¶æ•°é‡**ï¼šåŽ†å²å‘¨æœŸæœ€å¤šæ˜¾ç¤º52å‘¨/24æœˆ/10å¹´ï¼Œé˜²æ­¢åˆ—è¡¨è¿‡é•¿

### 6.2 ä»£ç è´¨é‡

1. **å®Œæ•´æ³¨é‡Š**ï¼šæ‰€æœ‰ç±»ã€æ–¹æ³•ã€å±žæ€§éƒ½æœ‰ä¸­æ–‡æ³¨é‡Š
2. **ä½œè€…æ ‡è®°**ï¼šç»Ÿä¸€æ ‡è®°ä½œè€…ä¸ºxiaolei
3. **ç±»åž‹å®‰å…¨**ï¼šå……åˆ†åˆ©ç”¨Swiftçš„ç±»åž‹ç³»ç»Ÿï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
4. **æ¨¡å—åŒ–è®¾è®¡**ï¼šè§†å›¾ç»„ä»¶ç‹¬ç«‹ï¼Œæ˜“äºŽç»´æŠ¤å’Œæµ‹è¯•

### 6.3 ç”¨æˆ·ä½“éªŒ

1. **æ™ºèƒ½é»˜è®¤**ï¼šæ‰“å¼€é¡µé¢è‡ªåŠ¨é€‰æ‹©"æœ¬å‘¨/æœ¬æœˆ/ä»Šå¹´"
2. **ç©ºçŠ¶æ€æç¤º**ï¼šæ— æ•°æ®æ—¶æ˜¾ç¤ºå‹å¥½æç¤ºä¿¡æ¯
3. **é¢œè‰²åŒºåˆ†**ï¼šæ”¶å…¥ç»¿è‰²ã€æ”¯å‡ºçº¢è‰²ã€ç»“ä½™è“è‰²/æ©™è‰²
4. **å›¾æ ‡è¯†åˆ«**ï¼šæ¯ä¸ªåˆ†ç±»å¸¦æœ‰ç‹¬ç‰¹çš„å›¾æ ‡å’Œé¢œè‰²

---

## ä¸ƒã€æ‰©å±•å»ºè®®

### 7.1 å¯é€‰åŠŸèƒ½å¢žå¼º

ä»¥ä¸‹åŠŸèƒ½å¯åœ¨åŽç»­è¿­ä»£ä¸­æ·»åŠ ï¼š

1. **å›¾è¡¨å¯è§†åŒ–**
   - ä½¿ç”¨Swift Chartsç»˜åˆ¶é¥¼å›¾
   - ä½¿ç”¨æŸ±çŠ¶å›¾å±•ç¤ºè¶‹åŠ¿å¯¹æ¯”
   - ä½¿ç”¨æŠ˜çº¿å›¾å±•ç¤ºæ”¶æ”¯æ›²çº¿

2. **é«˜çº§ç­›é€‰**
   - æŒ‰è´¦æˆ·ç­›é€‰
   - æŒ‰æ ‡ç­¾ç­›é€‰
   - è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´

3. **æ•°æ®å¯¼å‡º**
   - å¯¼å‡ºä¸ºCSVæ ¼å¼
   - å¯¼å‡ºä¸ºPDFæŠ¥è¡¨
   - åˆ†äº«åˆ°é‚®ä»¶/ç¤¾äº¤åº”ç”¨

4. **åŒæ¯”çŽ¯æ¯”åˆ†æž**
   - ä¸Žä¸Šå‘¨/ä¸Šæœˆ/åŽ»å¹´å¯¹æ¯”
   - æ˜¾ç¤ºå¢žé•¿çŽ‡/ä¸‹é™çŽ‡
   - æ ‡è®°å¼‚å¸¸æ³¢åŠ¨

5. **é¢„ç®—å¯¹æ¯”**
   - æ˜¾ç¤ºé¢„ç®—å®Œæˆåº¦
   - è¶…æ”¯é¢„è­¦
   - å‰©ä½™é¢„ç®—æç¤º

### 7.2 å®žçŽ°å»ºè®®

**æ·»åŠ å›¾è¡¨çš„æ­¥éª¤**ï¼š
1. åˆ›å»º `StatisticsChartView.swift`
2. ä½¿ç”¨ `import Charts`
3. æ·»åŠ Chartè§†å›¾åˆ°StatisticsView
4. ç»‘å®šç»Ÿè®¡æ•°æ®åˆ°Chart

**æ·»åŠ å¯¼å‡ºåŠŸèƒ½çš„æ­¥éª¤**ï¼š
1. åˆ›å»º `DataExporter.swift`
2. å®žçŽ°CSVç”Ÿæˆé€»è¾‘
3. åœ¨StatisticsViewå·¥å…·æ æ·»åŠ å¯¼å‡ºæŒ‰é’®
4. ä½¿ç”¨UIActivityViewControlleråˆ†äº«æ–‡ä»¶

---

## å…«ã€æ³¨æ„äº‹é¡¹

### 8.1 æ—¥æœŸå’Œæ—¶åŒº

- ä½¿ç”¨ `Calendar.current` ç¡®ä¿æœ¬åœ°åŒ–
- ä½¿ç”¨ `dateInterval(of:for:)` èŽ·å–å‘¨/æœˆ/å¹´çš„å‡†ç¡®æ—¶é—´èŒƒå›´
- æ‰€æœ‰æ—¥æœŸæ¯”è¾ƒä½¿ç”¨ `>=` å’Œ `<`ï¼Œé¿å…è¾¹ç•Œé—®é¢˜

### 8.2 æ•°æ®ä¸€è‡´æ€§

- ç»Ÿè®¡æ•°æ®å®žæ—¶è®¡ç®—ï¼Œæ— éœ€æŒä¹…åŒ–
- åˆ é™¤äº¤æ˜“åŽç»Ÿè®¡è‡ªåŠ¨æ›´æ–°
- åˆ†ç±»ä¿®æ”¹åŽç»Ÿè®¡æ­£ç¡®åæ˜ 

### 8.3 è¾¹ç•Œæƒ…å†µå¤„ç†

- æ— äº¤æ˜“è®°å½•ï¼šæ˜¾ç¤ºç©ºçŠ¶æ€æç¤º
- æœªåˆ†ç±»äº¤æ˜“ï¼šæ˜¾ç¤ºä¸º"æœªåˆ†ç±»"
- åˆ†ç±»è¢«åˆ é™¤ï¼šäº¤æ˜“çš„categoryä¸ºnilæ—¶æ˜¾ç¤º"æœªåˆ†ç±»"

---

## ä¹ã€æ€»ç»“

### 9.1 å®Œæˆæƒ…å†µ

âœ… **å·²å®ŒæˆåŠŸèƒ½**ï¼š
- [x] æ—¶é—´ç»´åº¦åˆ‡æ¢ï¼ˆå‘¨/æœˆ/å¹´ï¼‰
- [x] æ™ºèƒ½å‘¨æœŸé€‰æ‹©ï¼ˆæœ¬å‘¨ã€ä¸Šå‘¨ã€åŽ†å²å‘¨æœŸï¼‰
- [x] æ”¶æ”¯æ±‡æ€»ç»Ÿè®¡
- [x] åˆ†ç±»æ˜Žç»†ç»Ÿè®¡
- [x] ç™¾åˆ†æ¯”è®¡ç®—
- [x] UIç•Œé¢å®žçŽ°
- [x] ç©ºæ•°æ®çŠ¶æ€å¤„ç†
- [x] ä»£ç æ³¨é‡Šå’Œæ–‡æ¡£

### 9.2 ä»£ç ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°é‡ |
|------|------|
| æ–°å¢žæ–‡ä»¶ | 6ä¸ª |
| ä¿®æ”¹æ–‡ä»¶ | 1ä¸ª |
| æ€»ä»£ç é‡ | ~900è¡Œ |
| æ³¨é‡Šè¦†ç›–çŽ‡ | 100% |
| æ•°æ®æ¨¡åž‹ | 4ä¸ª |
| è§†å›¾ç»„ä»¶ | 4ä¸ª |
| æœåŠ¡ç±» | 1ä¸ª |

### 9.3 å¼€å‘æ—¶é—´

- æ¨¡åž‹è®¾è®¡ï¼š30åˆ†é’Ÿ
- æœåŠ¡å®žçŽ°ï¼š1å°æ—¶
- è§†å›¾å¼€å‘ï¼š1.5å°æ—¶
- é›†æˆæµ‹è¯•ï¼š30åˆ†é’Ÿ
- **æ€»è®¡ï¼šçº¦3.5å°æ—¶**

---

## åã€å¿«é€Ÿå‚è€ƒ

### 10.1 å…³é”®æ–‡ä»¶è·¯å¾„

```
ä¸»ç»Ÿè®¡é¡µé¢:
ExpenseTracker/Features/Statistics/Views/StatisticsView.swift

æ•°æ®æ¨¡åž‹:
ExpenseTracker/Features/Statistics/Models/StatisticsModels.swift

ä¸šåŠ¡é€»è¾‘:
ExpenseTracker/Features/Statistics/Services/StatisticsService.swift

ä¸»å¯¼èˆª:
ExpenseTracker/App/ContentView.swift (ç¬¬37-41è¡Œ)
```

### 10.2 å…³é”®æ–¹æ³•

```swift
// èŽ·å–å‘¨æœŸé€‰é¡¹
StatisticsService.getPeriodOptions(for: .week, modelContext: context)

// è®¡ç®—ç»Ÿè®¡æ•°æ®
StatisticsService.calculateStatistics(for: option, modelContext: context)
```

### 10.3 æ•°æ®æµå‘

```
ç”¨æˆ·é€‰æ‹©å‘¨æœŸ
    â†“
StatisticsView.loadPeriodOptions()
    â†“
StatisticsService.getPeriodOptions()
    â†“
è¿”å›ž [PeriodOption]
    â†“
ç”¨æˆ·é€‰æ‹©å…·ä½“é€‰é¡¹
    â†“
StatisticsView.calculateStatistics()
    â†“
StatisticsService.calculateStatistics()
    â†“
è¿”å›ž PeriodStatistics
    â†“
æ›´æ–°UIæ˜¾ç¤º
```

---

## é™„å½•

### A. ç›¸å…³æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®æ€»ä½“è¯´æ˜Ž
- [START_HERE.md](START_HERE.md) - å¿«é€Ÿå¯åŠ¨æŒ‡å—
- [åˆ†ç±»ç®¡ç†åŠŸèƒ½è¯´æ˜Ž.md](åˆ†ç±»ç®¡ç†åŠŸèƒ½è¯´æ˜Ž.md) - åˆ†ç±»ç®¡ç†è¯´æ˜Ž
- [äº¤æ˜“ç¼–è¾‘åŠŸèƒ½è¯´æ˜Ž.md](äº¤æ˜“ç¼–è¾‘åŠŸèƒ½è¯´æ˜Ž.md) - äº¤æ˜“ç¼–è¾‘è¯´æ˜Ž

### B. æŠ€æœ¯å‚è€ƒ

- SwiftUIå®˜æ–¹æ–‡æ¡£ï¼šhttps://developer.apple.com/documentation/swiftui
- SwiftDataå®˜æ–¹æ–‡æ¡£ï¼šhttps://developer.apple.com/documentation/swiftdata
- Swift Chartsï¼šhttps://developer.apple.com/documentation/charts

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0
**æœ€åŽæ›´æ–°**ï¼š2025å¹´11æœˆ13æ—¥
**ä½œè€…**ï¼šxiaolei
